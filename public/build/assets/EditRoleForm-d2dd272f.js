import{u as S,z as W,x as O,o as p,g as u,d as c,a as m,b as r,j as v,v as b,F as x,m as k,w as y,T as U,f as $,e as E,h as F}from"./app-a07534fc.js";import{_ as V}from"./InputError-819a2731.js";import{_ as d}from"./InputLabel-0d88b11e.js";import{_ as z}from"./PrimaryButton-f1dd44c4.js";import{_ as A}from"./TextInput-6d371888.js";const B=["onSubmit"],M={class:"grid grid-cols-6 justify-items-start gap-1"},R={class:"flex items-center gap-1 my-5"},T=["checked"],I={class:"grid md:grid-cols-4 grid-cols-3 gap-5 pr-5 sm:pr-0"},N={class:"flex items-center gap-1 mb-5"},D=["value","checked","onClick"],L=["value","onUpdate:modelValue"],q={class:"flex items-center justify-end pr-5 py-5"},J={key:0,class:"text-sm text-gray-600 dark:text-gray-400"},H={__name:"EditRoleForm",props:{permissionWithGroup:Object,permissions:Object,all_group:Object,total_permissions:String,total_group:String,role:Object,permissionArr:Object},setup(g){const n=g,e=S({id:n.role.id,name:n.role.name,permissions:n.permissionArr,group_name:[],is_all_selected:n.permissionArr.length==n.permissions.length});W(()=>{C()});const w=t=>{t?(e.permissions=_.clone(n.permissions),e.group_name=_.clone(n.all_group)):(e.permissions=[],e.group_name=[])},h=t=>{let l="";for(const s in n.permissionWithGroup){let o=n.permissionWithGroup[s].find(i=>i.name==t);o&&(l=o==null?void 0:o.group_name)}return l},C=()=>{for(const t in n.permissionWithGroup){let l=_.includes(e.group_name,t),s=n.permissionWithGroup[t],a=_.filter(e.permissions,function(o){return o.indexOf(t)>-1});!l&&(s==null?void 0:s.length)==(a==null?void 0:a.length)&&e.group_name.push(t)}};O(()=>e.permissions,(t,l)=>{let s="";l.length>t.length?s=h(_.difference(l,t)[0]):l.length<t.length&&(s=h(_.last(t)));let a=_.includes(e.group_name,s),o=n.permissionWithGroup[s],i=_.filter(t,function(f){return f.indexOf(s)>-1});t.length==n.permissions.length?(e.is_all_selected=!0,e.group_name=_.clone(n.all_group)):e.is_all_selected=!1,a&&(o==null?void 0:o.length)!==(i==null?void 0:i.length)?_.remove(e.group_name,f=>f===s):!a&&(o==null?void 0:o.length)==(i==null?void 0:i.length)&&(_.includes(e.group_name,s)||e.group_name.push(s))});const j=t=>{let l=n.permissionWithGroup[t];_.includes(e.group_name,t)?(_.remove(e.group_name,s=>s===t),_.forEach(l,function(s){_.remove(e.permissions,a=>a===s.name)})):(e.group_name.push(t),_.forEach(l,function(s){_.includes(e.permissions,s.name)||e.permissions.push(s.name)})),e.group_name.length==n.total_group?e.is_all_selected=!0:e.is_all_selected=!1},G=()=>{e.post(route("admin.role.update",e.id),{preserveScroll:!0,onSuccess:()=>e.reset(),onError:()=>{e.errors.name&&(e.reset("name"),nameInput.value.focus()),e.errors.permissions&&e.reset("permissions")}})};return(t,l)=>(p(),u("section",null,[c("form",{onSubmit:$(G,["prevent"]),class:"mt-6 space-y-6 p-3"},[c("div",M,[m(d,{for:"current_password",value:"Role Name :",class:"text-xl self-center"}),m(A,{id:"name",ref:"nameInput",modelValue:r(e).name,"onUpdate:modelValue":l[0]||(l[0]=s=>r(e).name=s),type:"text",class:"mt-1 block w-full col-span-5",autocomplete:"name"},null,8,["modelValue"]),m(V,{message:r(e).errors.name,class:"mt-2 col-start-2 col-span-4"},null,8,["message"])]),c("div",R,[m(d,{for:"is_all_selected",value:"Select All",class:"text-2xl capitalize mr-2"}),v(c("input",{type:"checkbox",id:"is_all_selected","onUpdate:modelValue":l[1]||(l[1]=s=>r(e).is_all_selected=s),class:"checkbox w-6 h-6",checked:r(e).is_all_selected,onChange:l[2]||(l[2]=s=>w(r(e).is_all_selected))},null,40,T),[[b,r(e).is_all_selected]]),m(V,{message:r(e).errors.permissions,class:"mt-2 col-start-2 col-span-4 ml-3"},null,8,["message"])]),c("div",I,[(p(!0),u(x,null,k(g.permissionWithGroup,(s,a)=>(p(),u("div",{key:a},[c("div",N,[c("input",{type:"checkbox",id:"group_name",value:r(e).group_name,class:"checkbox mr-1 w-5 h-5",checked:r(e).group_name.includes(a),onClick:o=>j(a)},null,8,D),m(d,{for:"group_name",value:a,class:"text-xl capitalize border-b-2 border-gray-700 border-spacing-2 pb-0.5"},null,8,["value"])]),(p(!0),u(x,null,k(s,o=>(p(),u("div",{key:o.id,class:"flex"},[v(c("input",{type:"checkbox",id:"permissions",value:o.name,"onUpdate:modelValue":i=>r(e).permissions=i,class:"checkbox mr-1"},null,8,L),[[b,r(e).permissions]]),m(d,{for:"permissions",value:o.name},null,8,["value"])]))),128))]))),128))]),c("div",q,[m(z,{disabled:r(e).processing},{default:y(()=>[E("Update")]),_:1},8,["disabled"]),m(U,{"enter-from-class":"opacity-0","leave-to-class":"opacity-0",class:"transition ease-in-out"},{default:y(()=>[r(e).recentlySuccessful?(p(),u("p",J," Updated. ")):F("",!0)]),_:1})])],40,B)]))}};export{H as default};
